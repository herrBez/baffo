filter {
  if [@metadata][ip_address] == "127.0.0.1" or [host] == "zizzo" {
    if [arcobaleno] == "134" {
        # This should be a warning given that host have been renamed
        mutate {
          add_field => {
            "[foo][boo]" => "Pizza"
          }
        }        
    }
  }
  
   else if [@metadata][foo] == "X.X.X.X" {
     mutate {
          add_field => {
            "[foo][boo]" => "Pizza"
          }
        }        
  } else if !([@metadata][foo] == "X.X.X.X"){
    mutate {
          add_field => {
            "[foo][boo]" => "Pizza"
          }
        }        
  } else {
    mutate {
      rename => {
        "[bii]" => "[boo]"
      }
    }
  }
}